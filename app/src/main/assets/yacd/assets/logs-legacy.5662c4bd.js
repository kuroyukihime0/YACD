System.register(["./index-legacy.5b293253.js"],(function(e){"use strict";var t,n,o;return{setters:[function(e){t=e.A,n=e.D,o=e.E}],execute:function(){e({f:b,r:function(e){i&&c&&(c.close(),g=!1,b(e,i))},s:function(){c.close(),a&&a.abort()}});const r="/logs",s=new TextDecoder("utf-8");let c,i,l,a,u=!1,g=!1,f="";function d(e,t){let n;try{n=JSON.parse(e)}catch(c){console.log("JSON.parse error",JSON.parse(e))}const r=new Date,s=function(e){const t=e.getFullYear()%100,n=o(e.getMonth()+1,2),r=o(e.getDate(),2),s=o(e.getHours(),2),c=o(e.getMinutes(),2),i=o(e.getSeconds(),2);return`${t}-${n}-${r} ${s}:${c}:${i}`}(r);n.time=s,n.id=+r-0+Math.floor(65536*(1+Math.random())).toString(16),n.even=u=!u,t(n)}function h(e,t){return e.read().then((({done:n,value:o})=>{const r=s.decode(o,{stream:!n});f+=r;const c=f.split("\n"),i=c[c.length-1];for(let e=0;e<c.length-1;e++)d(c[e],t);return n?(d(i,t),f="",console.log("GET /logs streaming done"),void(g=!1)):(f=i,h(e,t))}))}function v(e){const t=Object.keys(e);return t.sort(),t.map((t=>e[t])).join("|")}function b(e,o){if("uninit"===e.logLevel)return;if(g||c&&1===c.readyState)return;i=o;const s=t(e,r);c=new WebSocket(s),c.addEventListener("error",(()=>{!function(e,t){if(a&&v(e)!==l)a.abort();else if(g)return;g=!0,l=v(e),a=new AbortController;const o=a.signal,{url:s,init:c}=n(e);fetch(s+r+"?level="+e.logLevel,{...c,signal:o}).then((e=>{h(e.body.getReader(),t)}),(e=>{g=!1,o.aborted||console.log("GET /logs error:",e.message)}))}(e,o)})),c.addEventListener("message",(function(e){d(e.data,o)}))}}}}));
