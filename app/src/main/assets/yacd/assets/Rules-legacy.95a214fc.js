!function(){var e=document.createElement("style");e.innerHTML="._RuleProviderItem_12aid_1{display:grid;grid-template-columns:40px 1fr 46px;height:100%}._left_12aid_7{display:inline-flex;align-items:center;color:var(--color-text-secondary);opacity:.4}._middle_12aid_14{display:grid;gap:6px;grid-template-rows:1fr auto auto;align-items:center}._gray_12aid_21{color:#777}._action_12aid_25{display:grid;gap:4px;grid-template-columns:auto 1fr;align-items:center}._refreshBtn_12aid_32{padding:5px}._rule_1ymqx_1{display:flex;align-items:center;padding:6px 15px}@media screen and (min-width: 30em){._rule_1ymqx_1{padding:10px 40px}}._left_1ymqx_12{width:40px;padding-right:15px;color:var(--color-text-secondary);opacity:.4}._a_1ymqx_19{display:flex;align-items:center;font-size:12px;opacity:.8}._b_1ymqx_26{padding:10px 0;font-family:Roboto Mono,Menlo,monospace;font-size:16px}@media screen and (min-width: 30em){._b_1ymqx_26{font-size:19px}}._type_1ymqx_37{width:110px}._header_1j1w3_1{display:grid;grid-template-columns:1fr minmax(auto,330px);align-items:center;padding-right:15px}@media screen and (min-width: 30em){._header_1j1w3_1{padding-right:40px}}._RuleProviderItemWrapper_1j1w3_17{padding:6px 15px}@media screen and (min-width: 30em){._RuleProviderItemWrapper_1j1w3_17{padding:10px 40px}}\n",document.head.appendChild(e),System.register(["./index-legacy.5b293253.js","./index.esm-legacy.3ea06593.js","./TextFitler-legacy.bb03c431.js","./index-legacy.66c31b6c.js","./Fab-legacy.168bbd8f.js","./useRemainingViewPortHeight-legacy.036e499b.js","./debounce-legacy.6ce2b5eb.js"],(function(e){"use strict";var t,n,r,i,s,a,o,u,c,l,d,p,m,f,h,_,v,g,y,x,b,R,w,C,O,N,j,M,E,S,q;return{setters:[function(e){t=e._,n=e.Q,r=e.ah,i=e.ai,s=e.aj,a=e.R,o=e.ak,u=e.al,c=e.am,l=e.an,d=e.D,p=e.ao,m=e.ap,f=e.V,h=e.b,_=e.j,v=e.U,g=e.B,y=e.u,x=e.d,b=e.g,R=e.C,w=e.h},function(e){C=e.a,O=e.V},function(e){N=e.R,j=e.T},function(e){M=e.f},function(e){E=e.F,S=e.p},function(e){q=e.u},function(){}],execute:function(){var T=function(e){function s(t,n){var r;return(r=e.call(this)||this).client=t,r.setOptions(n),r.bindMethods(),r.updateResult(),r}t(s,e);var a=s.prototype;return a.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},a.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},a.onUnsubscribe=function(){var e;this.listeners.length||(null==(e=this.currentMutation)||e.removeObserver(this))},a.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)},a.getCurrentResult=function(){return this.currentResult},a.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},a.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,n({},this.options,{variables:void 0!==e?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},a.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:r(),t=n({},e,{isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset});this.currentResult=t},a.notify=function(e){var t=this;i.batch((function(){t.mutateOptions&&(e.onSuccess?(null==t.mutateOptions.onSuccess||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(null==t.mutateOptions.onError||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach((function(e){e(t.currentResult)}))}))},s}(s);function P(e,t,r){var s=a.useRef(!1),d=a.useState(0)[1],p=o(e,t,r),m=u(),f=a.useRef();f.current?f.current.setOptions(p):f.current=new T(m,p);var h=f.current.getCurrentResult();a.useEffect((function(){s.current=!0;var e=f.current.subscribe(i.batchCalls((function(){s.current&&d((function(e){return e+1}))})));return function(){s.current=!1,e()}}),[]);var _=a.useCallback((function(e,t){f.current.mutate(e,t).catch(c)}),[]);if(h.error&&l(void 0,f.current.options.useErrorBoundary,[h.error]))throw h.error;return n({},h,{mutate:_,mutateAsync:h.mutate})}async function k(e,t){const{url:n,init:r}=d(t);let i={providers:{}};try{const t=await fetch(n+e,r);t.ok&&(i=await t.json())}catch(s){console.log("failed to GET /providers/rules",s)}return function(e){const t=e.providers,n=Object.keys(t),r={};for(let i=0;i<n.length;i++){const e=n[i];r[e]={...t[e],idx:i}}return{byName:r,names:n}}(i)}async function I({name:e,apiConfig:t}){const{url:n,init:r}=d(t);try{return(await fetch(n+`/providers/rules/${e}`,{method:"PUT",...r})).ok}catch(i){return console.log("failed to PUT /providers/rules/:name",i),!1}}async function F({names:e,apiConfig:t}){for(let n=0;n<e.length;n++)await I({name:e[n],apiConfig:t})}var D=function(e,t,n,r,i,s,a,o){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,s,a,o],l=0;(u=new Error(t.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}};async function L(e,t){let n={rules:[]};try{const{url:r,init:i}=d(t),s=await fetch(r+e,i);s.ok&&(n=await s.json())}catch(r){console.log("failed to fetch rules",r)}return function(e){return D(e.rules&&e.rules.length>=0,"there is no valid rules list in the rules API response"),e.rules.map(((e,t)=>({...e,id:t})))}(n)}const U=p({key:"ruleFilterText",default:""});function z(e){return m(["/providers/rules",e],(()=>k("/providers/rules",e)))}var B="_RuleProviderItem_12aid_1",$="_left_12aid_7",A="_middle_12aid_14",V="_gray_12aid_21",Q="_action_12aid_25",W="_refreshBtn_12aid_32";function H({idx:e,name:t,vehicleType:n,behavior:r,updatedAt:i,ruleCount:s,apiConfig:a}){const[o,c]=function(e,t){const n=u(),{mutate:r,isLoading:i}=P(I,{onSuccess:()=>{n.invalidateQueries("/providers/rules")}});return[n=>{n.preventDefault(),r({name:e,apiConfig:t})},i]}(t,a),l=M(new Date(i),new Date);return h("div",{className:B,children:[_("span",{className:$,children:e}),h("div",{className:A,children:[_(v,{name:t,type:`${n} / ${r}`}),_("div",{className:V,children:s<2?`${s} rule`:`${s} rules`}),h("div",{className:Q,children:[h(g,{onClick:o,disabled:c,className:W,children:[_(N,{isRotating:c,size:13}),_("span",{className:"visually-hidden",children:"Refresh"})]}),h("small",{className:V,children:["Updated ",l," ago"]})]})]})]})}function G({apiConfig:e}){const[t,n]=function(e){const t=u(),{data:n}=z(e),{mutate:r,isLoading:i}=P(F,{onSuccess:()=>{t.invalidateQueries("/providers/rules")}});return[t=>{t.preventDefault(),r({names:n.names,apiConfig:e})},i]}(e),{t:r}=y();return _(E,{icon:_(N,{isRotating:n}),text:r("update_all_rule_provider"),style:S,onClick:t})}var J="_rule_1ymqx_1",K="_left_1ymqx_12",X="_a_1ymqx_19",Y="_b_1ymqx_26",Z="_type_1ymqx_37";const ee={_default:"#59caf9",DIRECT:"#f5bc41",REJECT:"#cb3166"};function te({type:e,payload:t,proxy:n,id:r}){const i=function({proxy:e}){let t=ee._default;return ee[e]&&(t=ee[e]),{color:t}}({proxy:n});return h("div",{className:J,children:[_("div",{className:K,children:r}),h("div",{children:[_("div",{className:Y,children:t}),h("div",{className:X,children:[_("div",{className:Z,children:e}),_("div",{style:i,children:n})]})]})]})}var ne="_header_1j1w3_1",re="_RuleProviderItemWrapper_1j1w3_17";const{memo:ie}=w;function se(e,{rules:t,provider:n}){const r=n.names.length;if(e<r)return n.names[e];return t[e-r].id}const ae=ie((({index:e,style:t,data:n})=>{const{rules:r,provider:i,apiConfig:s}=n,a=i.names.length;if(e<a){const n=i.names[e],r=i.byName[n];return _("div",{style:t,className:re,children:_(H,{apiConfig:s,...r})})}const o=r[e-a];return _("div",{style:t,children:_(te,{...o})})}),C);e("default",x((e=>({apiConfig:b(e)})))((function({apiConfig:e}){const[t,n]=q(),{rules:r,provider:i}=function(e){const{data:t,isFetching:n}=m(["/rules",e],(()=>L("/rules",e))),{data:r}=z(e),[i]=f(U);if(""===i)return{rules:t,provider:r,isFetching:n};{const e=i.toLowerCase();return{rules:t.filter((t=>t.payload.toLowerCase().indexOf(e)>=0)),isFetching:n,provider:{byName:r.byName,names:r.names.filter((t=>t.toLowerCase().indexOf(e)>=0))}}}}(e),s=function({provider:e}){return function(t){return t<e.names.length?110:80}}({provider:i}),{t:a}=y();return h("div",{children:[h("div",{className:ne,children:[_(R,{title:a("Rules")}),_(j,{placeholder:"Filter",textAtom:U})]}),_("div",{ref:t,style:{paddingBottom:30},children:_(O,{height:n-30,width:"100%",itemCount:r.length+i.names.length,itemSize:s,itemData:{rules:r,provider:i,apiConfig:e},itemKey:se,children:ae})}),i&&i.names&&i.names.length>0?_(G,{apiConfig:e}):null]})})))}}}))}();
