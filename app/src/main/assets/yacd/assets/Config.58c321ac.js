import{r as U,b as c,j as t,P as y,s as L,R as V,c as W,i as H,k as N,l as P,n as G,h as j,d as $,o as q,g as R,q as F,t as J,v as b,w as K,u as Q,C as X,x as Y,B as Z,y as ee,z as te}from"./index.5b186934.js";import{r as ne}from"./logs.c0e28075.js";import{S as w}from"./Select.4e6ef66c.js";function ae(e,l){if(e==null)return{};var r=oe(e,l),s,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)s=o[a],!(l.indexOf(s)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,s)||(r[s]=e[s]))}return r}function oe(e,l){if(e==null)return{};var r={},s=Object.keys(e),a,o;for(o=0;o<s.length;o++)a=s[o],!(l.indexOf(a)>=0)&&(r[a]=e[a]);return r}var S=U.exports.forwardRef(function(e,l){var r=e.color,s=r===void 0?"currentColor":r,a=e.size,o=a===void 0?24:a,u=ae(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...u,children:[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})});S.propTypes={color:y.string,size:y.oneOfType([y.string,y.number])};S.displayName="LogOut";var le=S;const{useState:se,useRef:re,useEffect:ce,useCallback:ie}=V;function de(e){return t("input",{className:L.input,...e})}function ue({value:e,...l}){const[r,s]=se(e),a=re(e);ce(()=>{a.current!==e&&s(e),a.current=e},[e]);const o=ie(u=>s(u.target.value),[s]);return t("input",{className:L.input,value:r,onChange:o,...l})}const pe="_root_1tdl3_1",he="_section_1tdl3_2",ge="_wrapSwitch_1tdl3_26",fe="_sep_1tdl3_32",me="_label_1tdl3_45";var d={root:pe,section:he,wrapSwitch:ge,sep:fe,label:me};const ve="_fieldset_1ghjp_1",ye="_input_1ghjp_9",Ce="_cnt_1ghjp_9";var k={fieldset:ve,input:ye,cnt:Ce};function be({OptionComponent:e,optionPropsList:l,selectedIndex:r,onChange:s}){const a=W("visually-hidden",k.input),o=u=>{s(u.target.value)};return t("fieldset",{className:k.fieldset,children:l.map((u,h)=>c("label",{children:[t("input",{type:"radio",checked:r===h,name:"selection",value:h,"aria-labelledby":"traffic chart type "+h,onChange:o,className:a}),t("div",{className:k.cnt,children:t(e,{...u})})]},h))})}const{useMemo:we}=j,ke={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},T=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Se=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],_e=T;function xe({id:e}){const l=H.read(),r=we(()=>({labels:_e,datasets:[{...N,...P[e].up,data:T},{...N,...P[e].down,data:Se}]}),[e]),s="chart-"+e;return G(l.Chart,s,r,null,ke),t("div",{style:{width:100,padding:5},children:t("canvas",{id:s})})}const{useEffect:M,useState:Oe,useCallback:g,useRef:Ie,useMemo:Ne}=j,Pe=[{id:0},{id:1},{id:2},{id:3}],Le=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],je=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],$e=[["zh","\u4E2D\u6587"],["en","English"]],Re=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],Te=e=>({configs:q(e),apiConfig:R(e)}),Me=e=>({selectedChartStyleIndex:ee(e),latencyTestUrl:te(e),apiConfig:R(e)}),ze=$(Me)(Ae);var Ve=$(Te)(Ee);function Ee({dispatch:e,configs:l,apiConfig:r}){return M(()=>{e(F(r))},[e,r]),t(ze,{configs:l})}function Ae({dispatch:e,configs:l,selectedChartStyleIndex:r,latencyTestUrl:s,apiConfig:a}){const[o,u]=Oe(l),h=Ie(l);M(()=>{h.current!==l&&u(l),h.current=l},[l]);const z=g(()=>{e(J("apiConfig"))},[e]),f=g((n,i)=>{u({...o,[n]:i})},[o]),E=g(n=>{const i="allow-lan",p=n;f(i,p),e(b(a,{"allow-lan":p}))},[a,e,f]),m=g(({name:n,value:i})=>{switch(n){case"mode":case"log-level":f(n,i),e(b(a,{[n]:i})),n==="log-level"&&ne({...a,logLevel:i});break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(i!==""){const p=parseInt(i,10);if(p<0||p>65535)return}f(n,i);break;default:return}},[a,e,f]),A=g(n=>m(n.target),[m]),{selectChartStyleIndex:B,updateAppConfig:_}=K(),x=g(n=>{const i=n.target,{name:p,value:I}=i;switch(p){case"port":case"socks-port":case"mixed-port":case"redir-port":{const C=parseInt(I,10);if(C<0||C>65535)return;e(b(a,{[p]:C}));break}case"latencyTestUrl":{_(p,I);break}default:throw new Error(`unknown input name ${p}`)}},[a,e,_]),D=Ne(()=>{const n=o.mode;return typeof n=="string"&&n[0].toUpperCase()+n.slice(1)},[o.mode]),{t:v,i18n:O}=Q();return c("div",{children:[t(X,{title:v("Config")}),c("div",{className:d.root,children:[je.map(n=>o[n.key]!==void 0?c("div",{children:[t("div",{className:d.label,children:n.label}),t(de,{name:n.key,value:o[n.key],onChange:A,onBlur:x})]},n.key):null),c("div",{children:[t("div",{className:d.label,children:"Mode"}),t(w,{options:Re,selected:D,onChange:n=>m({name:"mode",value:n.target.value})})]}),c("div",{children:[t("div",{className:d.label,children:"Log Level"}),t(w,{options:Le,selected:o["log-level"],onChange:n=>m({name:"log-level",value:n.target.value})})]}),c("div",{children:[t("div",{className:d.label,children:"Allow LAN"}),t("div",{className:d.wrapSwitch,children:t(Y,{name:"allow-lan",checked:o["allow-lan"],onChange:E})})]})]}),t("div",{className:d.sep,children:t("div",{})}),c("div",{className:d.section,children:[c("div",{children:[t("div",{className:d.label,children:v("latency_test_url")}),t(ue,{name:"latencyTestUrl",type:"text",value:s,onBlur:x})]}),c("div",{children:[t("div",{className:d.label,children:v("lang")}),t("div",{children:t(w,{options:$e,selected:O.language,onChange:n=>O.changeLanguage(n.target.value)})})]}),c("div",{children:[t("div",{className:d.label,children:v("chart_style")}),t(be,{OptionComponent:xe,optionPropsList:Pe,selectedIndex:r,onChange:B})]}),c("div",{children:[t("div",{className:d.label,children:"Action"}),t(Z,{start:t(le,{size:16}),label:"Switch backend",onClick:z})]})]})]})}export{Ve as default};
